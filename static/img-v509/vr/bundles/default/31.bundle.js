(window.webpackJsonpCMS=window.webpackJsonpCMS||[]).push([[31],{361:function(e,t,n){"use strict";n.r(t);var o=n(702),a=n(595);for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n(685);var s=n(0),r=Object(s.a)(a.default,o.a,o.b,!1,null,null,null);t.default=r.exports},595:function(e,t,n){"use strict";n.r(t);var o=n(596),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);t.default=a.a},596:function(e,t,n){"use strict";e.exports={mixins:[n(682)]}},597:function(e,t,n){},682:function(s,e,r){"use strict";(function(e,t){var n=r(1);r(12),r(9),r(6),r(13),r(14),r(10),r(7);var o=n(r(11));function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){(0,o.default)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}s.exports={name:"Websocket",computed:i({},e("appData",["isLogged"])),methods:i({},t("websocket",["createConnection"])),beforeCreate:function(){window.VuexModules.websocket||(this.$store.registerModule("websocket",r(683)),window.VuexModules.websocket=!0)},created:function(){this.isLogged?this.createConnection():setTimeout(this.createConnection,5e3)}}}).call(this,r(2).mapGetters,r(2).mapActions)},683:function(e,t,n){"use strict";var o=n(1);n(33),n(61),n(68);var a=o(n(21));n(22);var i=o(n(23));e.exports={namespaced:!0,modules:{"user-win-rating":n(684)},state:{socket:null,opened:!1,messagesStack:{popup:[]}},getters:{socket:function(e){return e.socket},socketPopupStack:function(e){return e.messagesStack.popup}},mutations:{setSocket:function(e,t){e.socket=t},isOpened:function(e){e.opened=!0},addPopupToStack:function(e,t){e.messagesStack.popup.push({type:"socket",data:t})}},actions:{createConnection:function(r,e){function t(){try{var e=window.appData.user?window.appData.user.id:"",t=c.mobile||window.appData.websocket.mobile,n=c.scope||window.appData.websocket.scope,o=c.secure||window.appData.websocket.secure,a=c.serverName||window.appData.websocket.serverName,i=["".concat(o?"wss":"ws","://"),"".concat(a,"/websockets/"),"".concat(n).concat(t?"-mob":"","/").concat(e)].join(""),s=new WebSocket(i);r.commit("setSocket",s),r.dispatch("handleOpen"),r.dispatch("handleClose"),r.dispatch("handleError"),r.dispatch("handleMessage")}catch(e){console.log(e)}}var c=1<arguments.length&&void 0!==e?e:{};if(null===r.state.socket)t();else var n=0,o=setInterval(function(){null===r.state.socket&&(clearInterval(o),t()),10<=++n&&(console.error("Can't connect to websocket server."),clearInterval(o))},500)},closeConnection:function(e){e.state.socket.close()},handleOpen:function(e){e.getters.socket.onopen=function(){e.commit("isOpened")}},handleClose:function(t){t.getters.socket.onclose=function(e){e.wasClean?console.info("Connection was closed by user."):console.warn("Connection was killed!"),console.log("Code: ".concat(e.code,", reason: ").concat(e.reason)),t.commit("setSocket",null)}},handleError:function(e){e.getters.socket.onerror=function(e){console.error("Websocket error: ".concat(e.message))}},handleMessage:function(i){i.state.socket.onmessage=function(e){var t=JSON.parse(e.data);switch(t.code){case"documentRequest":window.VuexModules.modal&&i.dispatch("modal/personal-data-approve/processRequest",t.request,{root:!0});break;case"happySpin":"function"==typeof window.showHappySpinPopup?window.showHappySpinPopup(t.id):i.dispatch("showHappySpin",t);break;case"happyCards":i.dispatch("showCardGame",t);break;case"firstDeposit":"function"==typeof window.onFirstDepositEvent&&window.onFirstDepositEvent();break;case"userWinRaiting":if("function"==typeof window.addWinToWinnersCarousel){var n=i.rootGetters["i18n/i18n"].t("feed","won"),o=i.rootGetters["i18n/i18n"].t("feed","in"),a=i.rootGetters["appData/isLogged"];window.addWinToWinnersCarousel(t.lastWin,n,o,a)}else i.dispatch("userWinRating",t);break;case"jackpot":"function"==typeof window.updateJackpotSum?window.updateJackpotSum(t.data):i.dispatch("jackpot",t);break;case"popup":i.dispatch("popup",t);break;case"updateProfileWidget":"function"==typeof window.updateProfileWidget&&window.updateProfileWidget(t);break;case"minBalanceMoneyEnd":"function"==typeof window.setLowCash&&window.setLowCash(),"function"==typeof window.showCashdeskInBetting&&window.showCashdeskInBetting();break;case"userBillingData":"function"==typeof window.updateUserBalance&&window.updateUserBalance(t),i.dispatch("userBillingData",t),i.dispatch("userCashback",t);break;case"tournament-standing-update":"function"==typeof window.updateWidgetLeaderboard?window.updateWidgetLeaderboard(t):i.dispatch("tournamentStandingUpdate",t);break;case"bonusMoneyWageringEnd":"function"==typeof window.hideMaxBetBanner?window.hideMaxBetBanner():document.dispatchEvent(new CustomEvent("bonusMoneyWageringEnd"));break;case"bonusDeactivated":i.dispatch("bonusDeactivated");break;case"bonusReceived":i.dispatch("bonusReceived");break;case"defferedRebillCallback":"function"==typeof window.updateDefferedRebill?window.updateDefferedRebill(t):i.dispatch("updateRebillStatus",t);break;case"achievementReceived":i.dispatch("updateAchievementsWidget",t.counter);break;case"reconnect":i.dispatch("closeConnection"),i.dispatch("createConnection",t.params)}}},userWinRating:function(e,t){window.VuexModules["user-win-rating"]&&e.dispatch("user-win-rating/addUserWinRating",t.lastWin)},userBillingData:function(e,t){e.commit("appData/setUserBalance",t,{root:!0})},userCashback:function(e,t){e.commit("appData/setUserCashback",t,{root:!0})},popup:function(e,t){"toast/toasts"in e.rootGetters?this.dispatch("toast/push",{type:"socket",data:t},{root:!0}):e.commit("addPopupToStack",t)},sale:function(e,t){window.VuexModules.bonus&&e.dispatch("bonus/updateSaleBySocket",t,{root:!0})},jackpot:function(e,t){window.VuexModules.jackpot&&e.dispatch("jackpot/updateSumBySocket",t.data,{root:!0})},tournamentStandingUpdate:function(e,t){var n=t.tournamentId,o=t.rating,a=t.standing,i=t.timeLeft;o.length&&(10<o.length&&(o=o.slice(0,10)),window.VuexModules.tournament&&e.commit("tournament/setBattleRating",{rating:o,id:n},{root:!0})),window.VuexModules.tournament&&e.commit("tournament/updateBattleData",{id:n,standing:a,timeLeft:i},{root:!0})},bonusDeactivated:function(t){return(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.VuexModules.bonus)return e.next=3,t.dispatch("bonus/fetch",null,{root:!0});e.next=3;break;case 3:case"end":return e.stop()}},e)}))()},bonusReceived:function(t){return(0,i.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.VuexModules.bonus)return e.next=3,t.dispatch("bonus/fetch",null,{root:!0});e.next=3;break;case 3:case"end":return e.stop()}},e)}))()},showCardGame:function(e,t){window.VuexModules.modal&&e.dispatch("modal/games-choose-card/processRequest",t,{root:!0})},showHappySpin:function(e,t){window.VuexModules.modal&&e.dispatch("modal/happy-spin/processRequest",t,{root:!0})},updateRebillStatus:function(e,t){window.VuexModules.rebill&&e.dispatch("rebill/setDefferedStatus",t,{root:!0})},updateAchievementsWidget:function(e,t){window.VuexModules.achievements&&e.dispatch("achievements/setWidgetValues",t,{root:!0})}}}},684:function(e,t,n){"use strict";var o=n(1);n(34),n(168);var a=o(n(21));n(22);var i=o(n(23));e.exports={namespaced:!0,state:{userWinRating:[],userWinRatingLoading:!1,userWinRatingBusy:!1},getters:{userWinRating:function(e){return e.userWinRating},userWinRatingLoading:function(e){return e.userWinRatingLoading}},mutations:{addUserWinRating:function(e,t){var n=e.userWinRating.length;12<n&&e.userWinRating.splice(n-1,1),e.userWinRating.unshift(t)},startUserWinRatingLoading:function(e){e.userWinRatingLoading=!0},finishUserWinRatingLoading:function(e){e.userWinRatingLoading=!1},setUserWinRatingBusy:function(e,t){e.userWinRatingBusy=t}},actions:{loadUserWinRating:function(n){return(0,i.default)(a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.getters.userWinRatingLoading){e.next=15;break}return n.commit("startUserWinRatingLoading"),e.prev=2,e.next=5,$.get(window.getUrl("actions","getWinnersList"));case 5:(t=e.sent).winners.length&&t.winners.reverse().map(function(e){n.commit("addUserWinRating",e)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.prev=12,n.commit("finishUserWinRatingLoading"),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[2,9,12,15]])}))()},addUserWinRating:function(e,t){var n=e.commit;e.state.userWinRatingBusy||(n("setUserWinRatingBusy",!0),n("addUserWinRating",t),setTimeout(function(){n("setUserWinRatingBusy",!1)},1e3))}}}},685:function(e,t,n){"use strict";var o=n(597);n.n(o).a},702:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a});var o=function(){var e=this.$createElement;return(this._self._c||e)("div",{attrs:{"data-websocket-instance":""}})},a=[]}}]);